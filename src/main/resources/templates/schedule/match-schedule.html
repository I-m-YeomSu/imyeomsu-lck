<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Corso - Training Course Landing Page Template</title>
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,400i,600,700,700i&display=swap" rel="stylesheet">
    <link href="../css/bootstrap.css" rel="stylesheet">
    <link href="../css/fontawesome-all.css" rel="stylesheet">
    <link href="../css/swiper.css" rel="stylesheet">
    <link href="../css/magnific-popup.css" rel="stylesheet">
    <link href="../css/styles.css" rel="stylesheet">
    <link rel="icon" href="images/favicon.png">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://kit.fontawesome.com/4e5b2f86bb.js" crossorigin="anonymous"></script>

    <!--font-->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/moonspam/NanumSquare@2.0/nanumsquare.css">
    <!-- modal -->
</head>

<body data-spy="scroll" data-target=".fixed-top">

<!-- Preloader -->
<div class="spinner-wrapper">
    <div class="spinner">
        <div class="bounce1"></div>
        <div class="bounce2"></div>
        <div class="bounce3"></div>
    </div>
</div>
<!-- end of preloader -->

<div th:insert="~{fragments/nav/template-nav :: template-nav}" class="replaceAttribute"></div>
<div th:insert="~{fragments/header/common-template-header :: common-template-header}" class="replaceAttribute"></div>
<div th:insert="~{fragments/utils/match-calender :: template-modal-calendar}" class="replaceAttribute"></div>

<div class="p-schedule-calendar">
    <div class="schedule-calendar">
        <span id="prevMonth" onclick="changeMonth(-1)">&#60;</span>
        <span id="currentDate"></span><i class="fas fa-regular fa-calendar-days ml-1" onclick="showCalendar()"></i>
        <span id="nextMonth" onclick="changeMonth(1)">&#62;</span>
    </div>

</div>

<div id="calendarModal" class="modal">
    <div class="modal-content2">
        <span class="close" onclick="closeModal()">&times;</span>
        <div class="calendar"></div>
    </div>
</div>

<div th:insert="~{fragments/main/match-schedule-wrapper :: match-schedule-wrapper}" class="replaceMatchScheduleWrapper"></div>

<div th:insert="~{fragments/footer/template-footer :: template-footer}" class="replaceAttribute"></div>
<div th:insert="~{fragments/footer/template-copyright :: template-copyright}" class="replaceAttribute"></div>

<!-- Scripts -->
<script src="../js/jquery.min.js"></script> <!-- jQuery for Bootstrap's JavaScript plugins -->
<script src="../js/popper.min.js"></script> <!-- Popper tooltip library for Bootstrap -->
<script src="../js/bootstrap.min.js"></script> <!-- Bootstrap framework -->
<script src="../js/jquery.easing.min.js"></script> <!-- jQuery Easing for smooth scrolling between anchors -->
<script src="../js/jquery.countdown.min.js"></script> <!-- The Final Countdown plugin for jQuery -->
<script src="../js/swiper.min.js"></script> <!-- Swiper for image and text sliders -->
<script src="../js/jquery.magnific-popup.js"></script> <!-- Magnific Popup for lightboxes -->
<script src="../js/validator.min.js"></script> <!-- Validator.js - Bootstrap plugin that validates forms -->
<script src="../js/scripts.js"></script> <!-- Custom scripts -->
<script src="../js/calendar.js"></script> <!-- Custom scripts -->

<script>let currentDate = new Date(2024, 3, 19); // 년, 월, 일 (월은 0부터 시작)

function changeMonth(offset) {
    currentDate.setMonth(currentDate.getMonth() + offset);
    updateDateDisplay();
}

function updateDateDisplay() {
    const year = currentDate.getFullYear();
    const month = currentDate.getMonth() + 1;
    const day = currentDate.getDate();
    const dateString = `${year}년 ${month.toString().padStart(2, '0')}월`;
    document.getElementById('currentDate').textContent = dateString;
}

function showCalendar() {
    const calendarModal = document.getElementById('calendarModal');


    calendarModal.style.display = 'block';

}

function closeModal() {
    const calendarModal = document.getElementById('calendarModal');
    calendarModal.style.display = 'none';
}

function renderCalendar() {
    const calendarElement = document.getElementById('calendar');
    calendarElement.innerHTML = ''; // 이전 달력 내용 제거

    const monthNames = ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'];
    const year = currentDate.getFullYear();
    const month = currentDate.getMonth();

    const calendarHeader = document.createElement('div');
    calendarHeader.textContent = `${year}년 ${monthNames[month]}`;
    calendarElement.appendChild(calendarHeader);

    const calendarBody = document.createElement('div');
    calendarBody.classList.add('calendar-body');
    calendarElement.appendChild(calendarBody);

    const firstDay = new Date(year, month, 1).getDay();
    const lastDate = new Date(year, month + 1, 0).getDate();

    let date = 1;
    for (let i = 0; i < 6; i++) {
        const week = document.createElement('div');
        week.classList.add('week');
        calendarBody.appendChild(week);

        for (let j = 0; j < 7; j++) {
            if (i === 0 && j < firstDay) {
                const emptyCell = document.createElement('div');
                emptyCell.classList.add('empty-cell');
                week.appendChild(emptyCell);
            } else if (date > lastDate) {
                break;
            } else {
                const cell = document.createElement('div');
                cell.classList.add('date-cell');
                cell.textContent = date;
                cell.addEventListener('click', () => handleDateClick(year, month + 1, date));
                week.appendChild(cell);
                date++;
            }
        }
    }
}

function handleDateClick(year, month, date) {
    const selectedDate = new Date(year, month - 1, date);
    const formattedMonth = month.toString().padStart(2, '0');
    const formattedDate = date.toString().padStart(2, '0');
    const formattedTime = selectedDate.toLocaleTimeString('ko-KR', { hour12: false });

    fetchMatchSchedule(year, formattedMonth, formattedDate, formattedTime);
    closeModal();
}

function fetchMatchSchedule(year, month, date, time) {
    const url = `/match-schedule?year=${year}&month=${month}&time=${time}&date=${date}`;

    // AJAX 요청 보내기
    fetch(url)
        .then(response => response.json())
        .then(data => {
            // 데이터 처리 로직 작성
            console.log(data);
        })
        .catch(error => {
            console.error('Error:', error);
        });
}

updateDateDisplay();

// 현재 날짜를 가져와서 currentDate에 표시하는 함수
function setCurrentDate() {
    var currentDateElement = document.getElementById("currentDate");
    var today = new Date();
    var dd = String(today.getDate()).padStart(2, '0');
    var mm = String(today.getMonth() + 1).padStart(2, '0'); // January is 0!
    var yyyy = today.getFullYear();
    currentDateElement.innerHTML = `${yyyy}년 ${mm}월`;
}

// 페이지 로드 시 현재 날짜를 표시
window.onload = function() {
    setCurrentDate();
};
function showCalendar() {
    const calendarControl = new CalendarControl();
    const modal = document.getElementById("calendarModal");
    modal.style.display = "block"; // 모달 표시
}

</script>



</body>
</html>
